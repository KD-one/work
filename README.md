# API接口文档
默认页面是用户登录页面，可以正常输入用户名密码登录，也可以以游客身份登录。  
正常输入用户名密码登录的用户具有权限，而以游客身份登录的用户没有权限。  
进入首页、上传文件、注册用户、下载文件需要权限。游客首页、游客文件下载不需要权限。  

**登录用户首页：**   
请求地址：GET http://192.168.1.188/index，    
请求参数：无   
响应参数：无

**用户登录前端页面：**  
请求地址：GET http://192.168.1.188，  
请求参数：  

| 字段       | 说明  | 类型       | 备注 | 是否必填 |
|----------|-----|----------| --- | --- |
| name     | 用户名 | text     | | 是 |
| password | 密码  | password  | | 是 |

响应参数：

| 字段       | 说明  | 类型       | 备注  | 是否必填 |
|----------|-----|----------|-----|------|
| message     | 状态信息 | text     |     | 是    |
| token | 权限钥匙  | any  | 只有登陆成功才将token保存在LocalStorage中    | 否    |

**用户登录后端逻辑：**  
请求地址：POST  http://192.168.1.188/login  
请求参数：

| 字段       | 说明  | 类型       | 备注 | 是否必填 |
|----------|-----|----------| --- | --- |
| name     | 用户名 | string   | | 是 |
| password | 密码  | string | | 是 |

响应参数：

| 字段      | 说明  | 类型   | 备注  | 是否必填 |
|---------|-----|------|-----|------|
| code     | 状态码 | int  |     | 是    |
| message | 状态信息 | string |     | 是    |
| token   | 权限钥匙  | string  | 只有登陆成功才发放token（有效期24h）    | 否    |

**上传文件前端页面：**  
请求地址：GET http://192.168.1.188/toUpload，  
请求参数：

| 字段       | 说明   | 类型     | 备注 | 是否必填 |
|----------|------|--------| --- | --- |
 | file     | 文件   | file   | | 是 |
 | branch     | 项目名  | text   | | 是 |
 | number     | 版本号  | text   | | 是 |
 | name     | 软件名  | text   | | 是 |
 | Authorization     | 身份验证 | string |在请求头中设置Authorization字段："Bearer"+token | 是 |

响应参数：

| 字段      | 说明  | 类型   | 备注  | 是否必填 |
|---------|-----|------|-----|------|
| message | 状态信息 | text |     | 是    |

**上传文件后端逻辑：**  
请求地址：POST  http://192.168.1.188/uploads，  
请求参数：

| 字段     | 说明  | 类型       | 备注 | 是否必填 |
|--------|-----|----------| --- | --- |
| file   | 文件  | []*multipart.FileHeader   | | 是 | 
| branch     | 项目名  | string    | | 是 |
| number     | 版本号  | string    | | 是 |
| name     | 软件名  | string    | | 是 |

响应参数：

| 字段      | 说明 | 类型   | 备注  | 是否必填 |
|---------|----|------|-----|------|
| status  | 状态 | string  |  "success"或"error"   | 是    |
| message | 状态信息 | string |     | 是    |

**下载文件前端页面：**  
请求地址：GET http://192.168.1.188/toDownload，  
请求参数：无  
响应参数：    

| 字段   | 说明  | 类型   | 备注  | 是否必填 |
|------|-----|------|-----|------|
| file | 文件  | application/octet-stream  |  浏览器通过字节流下载文件   | 是    |

**下载文件后端逻辑：**  
请求地址：GET http://192.168.1.188/:file，   
请求参数：

| 字段   | 说明  | 类型       | 备注 | 是否必填 |
|------|-----|----------| --- | --- |
| file | 文件  | string   | | 是 |

响应参数：

| 字段   | 说明  | 类型   | 备注  | 是否必填 |
|------|-----|------|-----|------|
| file | 文件  | application/octet-stream  |  将文件以字节流的形式写入响应并返回   | 是    |

**注册用户前端页面：**  
请求地址：GET http://192.168.1.188/toRegister，  
请求参数：

| 字段       | 说明  | 类型       | 备注 | 是否必填 |
|----------|-----|----------| --- | --- |
| name     | 用户名 | text     | | 是 |
| password | 密码  | password | | 是 |

响应参数：

| 字段      | 说明   | 类型   | 备注  | 是否必填 |
|---------|------|------|-----|------|
| message | 状态信息 | text |     | 是    |
**注册用户后端逻辑：**  
请求地址：POST  http://192.168.1.188/register  
请求参数：

| 字段       | 说明  | 类型       | 备注 | 是否必填 |
|----------|-----|----------| --- | --- |
| name     | 用户名 | string   | | 是 |
| password | 密码  | string | | 是 |

响应参数：

| 字段      | 说明  | 类型   | 备注  | 是否必填 |
|---------|-----|------|-----|------|
| code     | 状态码 | int  |     | 是    |
| message | 状态信息 | string |     | 是    |

**上传文件日志列表前端：**  
请求地址：GET  http://192.168.1.188/toListLogFiles  
请求参数：无  
响应参数：

| 字段    | 说明  | 类型  | 备注  | 是否必填 |
|-------|-----|-----|-----|------|
| files    | 文件列表 | <a> |  将文件以链接的形式展示   | 是 

**上传文件日志列表后端 ：**  
请求地址：GET  http://192.168.1.188/viewLogFile/:filename
请求参数：

| 字段       | 说明  | 类型       | 备注 | 是否必填 |
|----------|-----|----------| --- | --- |
| filename | 文件名 | string   | | 是 |

响应参数：

| 字段   | 说明   | 类型   | 备注  | 是否必填 |
|------|------|------|-----|------|
| data | 日志内容 | text/plain; charset=utf-8 |  文本类型| 是    |


**游客首页：**   
没登陆的游客首页只有文件下载标签，并且只能下载限定文件。

请求地址： http://192.168.1.188/visitorIndex，    
请求参数：无    
响应参数：无  

**游客下载文件前端页面：**    
请求地址： http://192.168.1.188/visitorToDownload，    
请求参数：无    
响应参数：    

| 字段   | 说明  | 类型   | 备注  | 是否必填 |
|------|-----|------|-----|------|
| file | 文件  | application/octet-stream  |  浏览器通过字节流下载文件   | 是    |

**游客下载文件后端逻辑：**  
请求地址：GET http://192.168.1.188/:file，  
请求参数：  

| 字段   | 说明  | 类型       | 备注 | 是否必填 |
|------|-----|----------| --- | --- |
| file | 文件名 | string   | | 是 |

响应参数：

| 字段   | 说明  | 类型   | 备注  | 是否必填 |
|------|-----|------|-----|------|
| file | 文件  | application/octet-stream  |  将文件以字节流的形式写入响应并返回   | 是    |

**更新文件前端页面：**  
请求地址：GET http://192.168.1.188/toUpdate，  
请求参数：

| 字段       | 说明   | 类型     | 备注 | 是否必填 |
|----------|------|--------| --- | --- |
| file     | 文件   | file   | | 是 |
| branch     | 项目名  | text   | | 是 |
| number     | 版本号  | text   | | 是 |
| name     | 软件名  | text   | | 是 |
| Authorization     | 身份验证 | string |在请求头中设置Authorization字段："Bearer"+token | 是 |

响应参数：

| 字段      | 说明  | 类型   | 备注  | 是否必填 |
|---------|-----|------|-----|------|
| message | 状态信息 | text |     | 是    |

**更新文件后端逻辑：**  
请求地址：POST  http://192.168.1.188/update，  
请求参数：

| 字段     | 说明  | 类型       | 备注 | 是否必填 |
|--------|-----|----------| --- | --- |
| branch     | 项目名  | string    | | 是 |
| number     | 版本号  | string    | | 是 |
| name     | 软件名  | string    | | 是 |
| file   | 文件  | []*multipart.FileHeader   | | 是 | 

响应参数：

| 字段      | 说明 | 类型   | 备注  | 是否必填 |
|---------|----|------|-----|------|
| status  | 状态 | string  |  "success"或"error"   | 是    |
| message | 状态信息 | string |     | 是    |

## 注意：
1. 上传文件务必上传a2l文件和构建文件，否则根据参数下载时记录找不到。而且也可以规范上传内容，防止上传内容混乱
2. 最好不要动upload文件夹中的内容
3. 上传文件时必须且只能上传一个a2l文件和一个构建文件（srz或hex）其他文件随意。
   合法上传例子：[1.a2l]、[1.hex]、(1.txt)、(1.doc)、(1.jpg)
   [ ] 必选 () 可选
4. 每次增加表或修改表时，都需要手动将model文件夹中的结构体新建或更新，然后需要在service文件夹下的database.go文件中更新函数